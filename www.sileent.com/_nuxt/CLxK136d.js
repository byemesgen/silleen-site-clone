import{_ as U}from"./DaGpothW.js";import{e as H,y as w,k as I,z as A,p as M,T as G,n as W,c as S,o as v,b as j,w as $,a as J,t as D,P as C,x as K,Q as X,I as Y,m as Z,f as L,E as ee,i as E,g as ne,F as ie,r as te,h as F,_ as ae,J as se}from"#entry";import{_ as re}from"./DWUvZI6Z.js";import{a as oe,d as le,u as de}from"./YXzScfQM.js";import"./CeHTQRai.js";const ce={class:"sr-only"},ue=H({__name:"ExperimentCard",props:{experiment:{},index:{}},emits:["hovering"],setup(e,{emit:n}){const i=e,t=n,d=w(null),l=w(null),m=I(),r=A(l),a=w({x:0,y:0,scale:1,width:0,height:0,visible:!0}),k=(o,s)=>({x:o.x/s.width*window.innerWidth,y:-(o.y/s.height)*window.innerHeight}),b=(o,s)=>({width:o.x/s.width*window.innerWidth,height:o.y/s.height*window.innerHeight}),N=()=>{if(!d.value)return;const s=C.getVideos()[i.index];if(!s)return;const{renderer:u}=s,c=u.mesh,f=m.$three.viewport,x=k({x:c.position.x,y:c.position.y},f),g=b({x:c.scale.x,y:c.scale.y},f);a.value.x=x.x,a.value.y=x.y,a.value.width=g.width,a.value.height=g.height,a.value.visible=c.visible,a.value.scale=1,K.set(d.value,{position:"fixed",left:"50%",top:"50%",xPercent:-50,yPercent:-50,x:a.value.x,y:a.value.y,width:`${a.value.width}px`,height:`${a.value.height}px`,visibility:a.value.visible?"visible":"hidden",pointerEvents:"auto",zIndex:11})};return M(()=>{G.add(N,{fps:m.$device.isMobileOrTablet?30:60})}),W(r,o=>{t("hovering",o)}),(o,s)=>{const u=U;return v(),S("div",{ref_key:"containerRef",ref:d,class:"will-change-transform bg-red/0"},[j(u,{ref_key:"target",ref:l,class:"block w-full h-full","aria-label":`${o.$t("Go to")} ${o.experiment.title}`,"aria-title":o.experiment.slug,to:{name:"lab-slug",params:{slug:o.experiment.slug},state:{index:o.index}}},{default:$(()=>[J("h2",ce,D(o.experiment.title),1)]),_:1},8,["aria-label","aria-title","to"])],512)}}}),me=Object.assign(ue,{__name:"ExperimentCard"});var h={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ExperimentCard"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Experiment"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"documentId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"thumbnail"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cover"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"StrapiFile"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"videoUrl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"mobileThumbnail"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cover"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"StrapiFile"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"videoUrl"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:261}};h.loc.source={body:`#import ./StrapiFile.gql

fragment ExperimentCard on Experiment {
  documentId
  slug
  title
  label
  thumbnail {
    id
    cover {
      ...StrapiFile
    }
    videoUrl
  }
  mobileThumbnail {
    id
    cover {
      ...StrapiFile
    }
    videoUrl
  }
}`,name:"GraphQL request",locationOffset:{line:1,column:1}};var O={};function fe(e){return e.filter(function(n){if(n.kind!=="FragmentDefinition")return!0;var i=n.name.value;return O[i]?!1:(O[i]=!0,!0)})}h.definitions=h.definitions.concat(fe(oe.definitions));function _(e,n){if(e.kind==="FragmentSpread")n.add(e.name.value);else if(e.kind==="VariableDefinition"){var i=e.type;i.kind==="NamedType"&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(t){_(t,n)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(t){_(t,n)}),e.definitions&&e.definitions.forEach(function(t){_(t,n)})}var T={};(function(){h.definitions.forEach(function(n){if(n.name){var i=new Set;_(n,i),T[n.name.value]=i}})})();function P(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}function ve(e,n){var i={kind:e.kind,definitions:[P(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=T[n]||new Set,d=new Set,l=new Set;for(t.forEach(function(r){l.add(r)});l.size>0;){var m=l;l=new Set,m.forEach(function(r){if(!d.has(r)){d.add(r);var a=T[r]||new Set;a.forEach(function(k){l.add(k)})}})}return d.forEach(function(r){var a=P(e,r);a&&i.definitions.push(a)}),i}ve(h,"ExperimentCard");var p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PageLab"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"status"}},type:{kind:"NamedType",name:{kind:"Name",value:"PublicationStatus"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NamedType",name:{kind:"Name",value:"I18NLocaleCode"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"content"},name:{kind:"Name",value:"pageLab"},arguments:[{kind:"Argument",name:{kind:"Name",value:"status"},value:{kind:"Variable",name:{kind:"Name",value:"status"}}},{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"experiments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"pagination"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ExperimentCard"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"seo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SEOMeta"},directives:[]}]}}]}}]}}],loc:{start:0,end:309}};p.loc.source={body:`#import ./fragments/ExperimentCard.gql
#import ./fragments/SEOMeta.gql

query PageLab($status: PublicationStatus, $locale: I18NLocaleCode) {
  content: pageLab(status: $status, locale: $locale) {
    experiments(pagination: { limit: 20 }) {
      ...ExperimentCard
    }
    seo {
      ...SEOMeta
    }
  }
}`,name:"GraphQL request",locationOffset:{line:1,column:1}};var R={};function z(e){return e.filter(function(n){if(n.kind!=="FragmentDefinition")return!0;var i=n.name.value;return R[i]?!1:(R[i]=!0,!0)})}p.definitions=p.definitions.concat(z(h.definitions));p.definitions=p.definitions.concat(z(le.definitions));function y(e,n){if(e.kind==="FragmentSpread")n.add(e.name.value);else if(e.kind==="VariableDefinition"){var i=e.type;i.kind==="NamedType"&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(t){y(t,n)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(t){y(t,n)}),e.definitions&&e.definitions.forEach(function(t){y(t,n)})}var V={};(function(){p.definitions.forEach(function(n){if(n.name){var i=new Set;y(n,i),V[n.name.value]=i}})})();function q(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}function pe(e,n){var i={kind:e.kind,definitions:[q(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=V[n]||new Set,d=new Set,l=new Set;for(t.forEach(function(r){l.add(r)});l.size>0;){var m=l;l=new Set,m.forEach(function(r){if(!d.has(r)){d.add(r);var a=V[r]||new Set;a.forEach(function(k){l.add(k)})}})}return d.forEach(function(r){var a=q(e,r);a&&i.definitions.push(a)}),i}pe(p,"PageLab");const ke={class:"lab absolute inset-0 overflow-clip c-white"},he={key:0,class:"inline-flex w-12 justify-center text-small c-black uppercase"},ge={key:1,class:"inline-flex w-12 justify-center text-small c-black uppercase"},ye=H({__name:"index",async setup(e){let n,i;const t=I(),{expectVideos:d,onAllVideosLoaded:l}=ee(),m=X(),r=A(m),a=w(!1),k=Y(a,250),{content:b}=([n,i]=Z(()=>de("lab",p)),n=await n,i(),n),N=L(()=>b.value.experiments.map(({slug:s})=>s)),o=L(()=>{const s=b.value.experiments,u=t.$breakpoints.md?24:12;if(s.length>=u)return s;const c=[];for(let f=0;f<u;f++)c.push(s[f%s.length]);return c});return M(()=>{d(N.value),C.init(t,o.value),l(()=>{C.transitionIn()})}),(s,u)=>{const c=me,f=re,x=ae;return v(),S("div",ke,[(v(!0),S(ie,null,te(F(o),(g,Q)=>(v(),E(c,{key:g.slug,experiment:g,index:Q,onHovering:u[0]||(u[0]=B=>a.value=B)},null,8,["experiment","index"]))),128)),F(r)&&!s.$device.isMobile?(v(),E(x,{key:0},{default:$(()=>[(v(),E(se,{defer:"",to:"#site-cursor"},[j(f,{alignment:"center"},{default:$(()=>[F(k)?(v(),S("span",he,D(s.$t("View")),1)):(v(),S("span",ge,D(s.$t("Scroll")),1))]),_:1})]))]),_:1})):ne("",!0)])}}});export{ye as default};
